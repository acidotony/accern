{
  "version": 4,
  "terraform_version": "1.9.3",
  "serial": 76,
  "lineage": "4b3583f1-6f22-4654-1a0b-0810bc94c8fd",
  "outputs": {},
  "resources": [
    {
      "module": "module.allowed_locations",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "allowed_locations",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the 'global' region.",
            "display_name": "Allowed locations",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "management_group_name": null,
            "metadata": "{\"category\":\"General\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "parameters": "{\"listOfAllowedLocations\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The list of locations that can be specified when deploying resources.\",\"displayName\":\"Allowed locations\",\"strongType\":\"location\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"location\",\"notIn\":\"[parameters('listOfAllowedLocations')]\"},{\"field\":\"location\",\"notEquals\":\"global\"},{\"field\":\"type\",\"notEquals\":\"Microsoft.AzureActiveDirectory/b2cDirectories\"}]},\"then\":{\"effect\":\"deny\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.allowed_locations",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "allowed_locations",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Allowed locations",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/Accern-Root/providers/Microsoft.Authorization/policyAssignments/allowed-locations",
            "identity": [],
            "location": "",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/Accern-Root",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:56:31.5124059Z\",\"parameterScopes\":{\"listOfAllowedLocations\":\"/providers/Microsoft.Management/managementGroups/Accern-Root\"},\"updatedBy\":null,\"updatedOn\":null}",
            "name": "allowed-locations",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus2\",\"westus2\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.allowed_locations.data.azurerm_policy_definition.allowed_locations",
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        }
      ]
    },
    {
      "module": "module.allowed_locations",
      "mode": "managed",
      "type": "azurerm_subscription_policy_assignment",
      "name": "allowed_locations",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Allowed locations",
            "enforce": true,
            "id": "/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf/providers/Microsoft.Authorization/policyAssignments/allowed-locations-e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "identity": [],
            "location": "",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:56:31.4241995Z\",\"parameterScopes\":{\"listOfAllowedLocations\":\"e12ce4d3-a17b-4aa7-8b8a-10abb4546edf\"},\"updatedBy\":null,\"updatedOn\":null}",
            "name": "allowed-locations-e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus2\",\"westus2\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "resource_selectors": [],
            "subscription_id": "/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.allowed_locations.data.azurerm_policy_definition.allowed_locations",
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        }
      ]
    },
    {
      "module": "module.allowed_skus",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "allowed_skus",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to specify a set of virtual machine size SKUs that your organization can deploy.",
            "display_name": "Allowed virtual machine size SKUs",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Compute\",\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "cccc23c7-8427-4f53-ad12-b6a63eb452b3",
            "parameters": "{\"listOfAllowedSKUs\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The list of size SKUs that can be specified for virtual machines.\",\"displayName\":\"Allowed Size SKUs\",\"strongType\":\"VMSKUs\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Compute/virtualMachines/sku.name\",\"in\":\"[parameters('listOfAllowedSKUs')]\"}}]},\"then\":{\"effect\":\"Deny\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.allowed_skus",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "allowed_skus",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Allowed virtual machine size SKUs",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/acn-landingzones/providers/Microsoft.Authorization/policyAssignments/allowed-skus",
            "identity": [],
            "location": "",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/acn-landingzones",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:56:31.6321704Z\",\"parameterScopes\":{\"listOfAllowedSKUs\":\"/providers/Microsoft.Management/managementGroups/acn-landingzones\"},\"updatedBy\":null,\"updatedOn\":null}",
            "name": "allowed-skus",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{\"listOfAllowedSKUs\":{\"value\":[\"Standard_B2s\",\"Standard_D2s_v3\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.allowed_skus.data.azurerm_policy_definition.allowed_skus",
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        }
      ]
    },
    {
      "module": "module.allowed_skus",
      "mode": "managed",
      "type": "azurerm_subscription_policy_assignment",
      "name": "allowed_skus",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Allowed virtual machine size SKUs",
            "enforce": true,
            "id": "/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf/providers/Microsoft.Authorization/policyAssignments/allowed-skus-e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "identity": [],
            "location": "",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:56:31.5504123Z\",\"parameterScopes\":{\"listOfAllowedSKUs\":\"e12ce4d3-a17b-4aa7-8b8a-10abb4546edf\"},\"updatedBy\":null,\"updatedOn\":null}",
            "name": "allowed-skus-e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{\"listOfAllowedSKUs\":{\"value\":[\"Standard_B2s\",\"Standard_D2s_v3\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3",
            "resource_selectors": [],
            "subscription_id": "/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.allowed_skus.data.azurerm_policy_definition.allowed_skus",
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        }
      ]
    },
    {
      "module": "module.management_groups_level1",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "acn-decommissioned",
          "schema_version": 0,
          "attributes": {
            "display_name": "Accern Decommissioned",
            "id": "/providers/Microsoft.Management/managementGroups/acn-decommissioned",
            "name": "acn-decommissioned",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/Accern-Root",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/ba25e9e3-d4c7-404f-9b1b-fabe3a40f2d3/providers/Microsoft.Management/managementGroups/acn-decommissioned",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        },
        {
          "index_key": "acn-landingzones",
          "schema_version": 0,
          "attributes": {
            "display_name": "Accern Landing Zones",
            "id": "/providers/Microsoft.Management/managementGroups/acn-landingzones",
            "name": "acn-landingzones",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/Accern-Root",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/ba25e9e3-d4c7-404f-9b1b-fabe3a40f2d3/providers/Microsoft.Management/managementGroups/acn-landingzones",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        },
        {
          "index_key": "acn-platform",
          "schema_version": 0,
          "attributes": {
            "display_name": "Accern Platform",
            "id": "/providers/Microsoft.Management/managementGroups/acn-platform",
            "name": "acn-platform",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/Accern-Root",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/ba25e9e3-d4c7-404f-9b1b-fabe3a40f2d3/providers/Microsoft.Management/managementGroups/acn-platform",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        },
        {
          "index_key": "acn-sandboxes",
          "schema_version": 0,
          "attributes": {
            "display_name": "Accern Sandboxes",
            "id": "/providers/Microsoft.Management/managementGroups/acn-sandboxes",
            "name": "acn-sandboxes",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/Accern-Root",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/ba25e9e3-d4c7-404f-9b1b-fabe3a40f2d3/providers/Microsoft.Management/managementGroups/acn-sandboxes",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        }
      ]
    },
    {
      "module": "module.management_groups_level2",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "acn-development",
          "schema_version": 0,
          "attributes": {
            "display_name": "Accern Landing Zones Development",
            "id": "/providers/Microsoft.Management/managementGroups/acn-development",
            "name": "acn-development",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/acn-landingzones",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/ba25e9e3-d4c7-404f-9b1b-fabe3a40f2d3/providers/Microsoft.Management/managementGroups/acn-development",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        },
        {
          "index_key": "acn-platform-services",
          "schema_version": 0,
          "attributes": {
            "display_name": "Accern Platform Services",
            "id": "/providers/Microsoft.Management/managementGroups/acn-platform-services",
            "name": "acn-platform-services",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/acn-platform",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/ba25e9e3-d4c7-404f-9b1b-fabe3a40f2d3/providers/Microsoft.Management/managementGroups/acn-platform-services",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        },
        {
          "index_key": "acn-production",
          "schema_version": 0,
          "attributes": {
            "display_name": "Accern Landing Zones Production",
            "id": "/providers/Microsoft.Management/managementGroups/acn-production",
            "name": "acn-production",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/acn-landingzones",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/ba25e9e3-d4c7-404f-9b1b-fabe3a40f2d3/providers/Microsoft.Management/managementGroups/acn-production",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        }
      ]
    },
    {
      "module": "module.management_groups_level2",
      "mode": "managed",
      "type": "azurerm_management_group_subscription_association",
      "name": "subscriptions",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "acn-platform-services",
          "schema_version": 1,
          "attributes": {
            "id": "/providers/Microsoft.Management/managementGroups/acn-platform-services/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/acn-platform-services",
            "subscription_id": "/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJyZWFkIjozMDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        },
        {
          "index_key": "acn-production",
          "schema_version": 1,
          "attributes": {
            "id": "/providers/Microsoft.Management/managementGroups/acn-production/subscriptions/2489b659-81f7-4abe-9eb4-e4cca732d892",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/acn-production",
            "subscription_id": "/subscriptions/2489b659-81f7-4abe-9eb4-e4cca732d892",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJyZWFkIjozMDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        }
      ]
    },
    {
      "module": "module.management_groups_root",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "Accern-Root",
          "schema_version": 0,
          "attributes": {
            "display_name": "Accern Root",
            "id": "/providers/Microsoft.Management/managementGroups/Accern-Root",
            "name": "Accern-Root",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/ba25e9e3-d4c7-404f-9b1b-fabe3a40f2d3",
            "subscription_ids": [],
            "tenant_scoped_id": "/tenants/ba25e9e3-d4c7-404f-9b1b-fabe3a40f2d3/providers/Microsoft.Management/managementGroups/Accern-Root",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "module": "module.mfa_for_owners",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "owner-mfa-enabled",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with owner permissions to prevent a breach of accounts or resources.",
            "display_name": "Accounts with owner permissions on Azure resources should be MFA enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e3e008c3-56b9-4133-8fd7-d3347377402a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "e3e008c3-56b9-4133-8fd7-d3347377402a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"6240402e-f77c-46fa-9060-a7ce53997754\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.mfa_for_owners",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "owner-mfa-enabled",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/Accern-Root",
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Accounts with owner permissions on Azure resources should be MFA enabled",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/Accern-Root/providers/Microsoft.Authorization/policyAssignments/mfa--Root",
            "identity": [],
            "location": "",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/Accern-Root",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:56:31.5952429Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "mfa--Root",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"AuditIfNotExists\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e3e008c3-56b9-4133-8fd7-d3347377402a",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions",
            "module.mfa_for_owners.data.azurerm_policy_definition.owner-mfa-enabled"
          ]
        }
      ]
    },
    {
      "module": "module.mfa_for_owners",
      "mode": "managed",
      "type": "azurerm_subscription_policy_assignment",
      "name": "owner-mfa-enabled",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Accounts with owner permissions on Azure resources should be MFA enabled",
            "enforce": true,
            "id": "/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf/providers/Microsoft.Authorization/policyAssignments/mfa-e12ce4d3-a17b-4aa7-8",
            "identity": [],
            "location": "",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:56:31.4917501Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "mfa-e12ce4d3-a17b-4aa7-8",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{\"effect\":{\"value\":\"AuditIfNotExists\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e3e008c3-56b9-4133-8fd7-d3347377402a",
            "resource_selectors": [],
            "subscription_id": "/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions",
            "module.mfa_for_owners.data.azurerm_policy_definition.owner-mfa-enabled"
          ]
        }
      ]
    },
    {
      "module": "module.nics_no_pip",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "nics_no_pip",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the network interfaces which are configured with any public IP. Public IP addresses allow internet resources to communicate inbound to Azure resources, and Azure resources to communicate outbound to the internet. This should be reviewed by the network security team.",
            "display_name": "Network interfaces should not have public IPs",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "83a86a26-fd1f-447c-b59d-e51f44264114",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkInterfaces\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/networkInterfaces/ipconfigurations[*].publicIpAddress.id\",\"notLike\":\"*\"}}]},\"then\":{\"effect\":\"deny\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.nics_no_pip",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "nics_no_pip",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Network interfaces should not have public IPs",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/acn-landingzones/providers/Microsoft.Authorization/policyAssignments/nics-no-pip",
            "identity": [],
            "location": "",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/acn-landingzones",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:56:31.5662923Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "nics-no-pip",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions",
            "module.nics_no_pip.data.azurerm_policy_definition.nics_no_pip"
          ]
        }
      ]
    },
    {
      "module": "module.nics_no_pip",
      "mode": "managed",
      "type": "azurerm_subscription_policy_assignment",
      "name": "nics_no_pip",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Network interfaces should not have public IPs",
            "enforce": true,
            "id": "/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf/providers/Microsoft.Authorization/policyAssignments/nics-no-pip-e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "identity": [],
            "location": "",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:56:31.5158964Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "nics-no-pip-e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
            "resource_selectors": [],
            "subscription_id": "/subscriptions/e12ce4d3-a17b-4aa7-8b8a-10abb4546edf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions",
            "module.nics_no_pip.data.azurerm_policy_definition.nics_no_pip"
          ]
        }
      ]
    },
    {
      "module": "module.require_tag_on_rg",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "mng_require_tags_on_rg_custom",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/Accern-Root",
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Custom: Require tags (Environment, deploymentBy) on resource groups (except MC_*)",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/Accern-Root/providers/Microsoft.Authorization/policyAssignments/cus-mng-pol-tags--Root",
            "identity": [],
            "location": "",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/Accern-Root",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:57:58.8983045Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "cus-mng-pol-tags--Root",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{\"tagNames\":{\"value\":[\"Environment\",\"deploymentBy\"]}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/Accern-Root/providers/Microsoft.Authorization/policyDefinitions/require-tags-on-rg--Root",
            "resource_selectors": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions",
            "module.require_tag_on_rg.azurerm_policy_definition.require_tags_on_rg_mng_grp_scope_custom"
          ]
        }
      ]
    },
    {
      "module": "module.require_tag_on_rg",
      "mode": "managed",
      "type": "azurerm_policy_definition",
      "name": "require_tags_on_rg_mng_grp_scope_custom",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/Accern-Root",
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "Require tags on resource groups except those starting with 'MC_' at Management Group Scope",
            "id": "/providers/Microsoft.Management/managementGroups/Accern-Root/providers/Microsoft.Authorization/policyDefinitions/require-tags-on-rg--Root",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/Accern-Root",
            "metadata": "{\"createdBy\":\"d374bafa-9bbd-483d-ac1a-be9875e719fb\",\"createdOn\":\"2024-12-16T19:56:25.9229395Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "mode": "All",
            "name": "require-tags-on-rg--Root",
            "parameters": "{\"tagNames\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The names of the tags to enforce on resource groups.\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Management/managementGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"exists\":\"true\",\"field\":\"[concat('tags[', parameters('tagNames')[0], ']')]\"},{\"exists\":\"true\",\"field\":\"[concat('tags[', parameters('tagNames')[1], ']')]\"}]},\"type\":\"Microsoft.Resources/tags\"},\"effect\":\"auditIfNotExists\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.management_groups_level1.azurerm_management_group.this",
            "module.management_groups_level1.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_level2.azurerm_management_group.this",
            "module.management_groups_level2.azurerm_management_group_subscription_association.subscriptions",
            "module.management_groups_root.azurerm_management_group.this",
            "module.management_groups_root.azurerm_management_group_subscription_association.subscriptions"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
